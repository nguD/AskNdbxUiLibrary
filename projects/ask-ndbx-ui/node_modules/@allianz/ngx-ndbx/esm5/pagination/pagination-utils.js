/**
 * @fileoverview added by tsickle
 * Generated from: pagination/pagination-utils.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
/**
 * \@docs-private
 */
var NxPaginationUtils = /** @class */ (function () {
    function NxPaginationUtils() {
        this._pagesMobile = 3;
        this._elipsisText = '...';
        this._classExpanded = 'expanded-view';
    }
    /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    NxPaginationUtils.prototype.getPages = /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    function (currentPage, totalPages) {
        /** @type {?} */
        var pages = [];
        /** @type {?} */
        var start = [];
        /** @type {?} */
        var middle = [];
        /** @type {?} */
        var end = [];
        // First array -> start
        start = this.getStartArray(currentPage, totalPages);
        // Second array -> middle
        middle = this.getMiddleArray(currentPage, totalPages);
        // Third array -> end
        end = this.getEndArray(currentPage, totalPages);
        pages = tslib_1.__spread(start, middle, end);
        return pages;
    };
    /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    NxPaginationUtils.prototype.getMiddleArray = /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    function (currentPage, totalPages) {
        /** @type {?} */
        var pageNumber = currentPage < 6 ? 4 : currentPage - 1;
        /** @type {?} */
        var middle = [];
        while (middle.length < 3 &&
            pageNumber >= 2 &&
            pageNumber <= totalPages - 3 &&
            (pageNumber <= currentPage + 1 && pageNumber >= currentPage - 1)) {
            middle.push(this.createPaginationItem(pageNumber, pageNumber));
            pageNumber++;
        }
        return middle;
    };
    /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    NxPaginationUtils.prototype.getEndArray = /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    function (currentPage, totalPages) {
        /** @type {?} */
        var end = [];
        /** @type {?} */
        var currentItemToShow = totalPages <= 3 ? totalPages + 1 :
            totalPages <= 6 ? totalPages - (totalPages - 4) : totalPages - 2;
        /** @type {?} */
        var showEllipsis = currentPage < totalPages - 4;
        while (currentItemToShow <= totalPages) {
            /** @type {?} */
            var endItem = end.length === 0 && showEllipsis ?
                this.createPaginationItem(this._elipsisText, currentItemToShow, true) :
                this.createPaginationItem(currentItemToShow, currentItemToShow, true);
            end.push(endItem);
            currentItemToShow++;
        }
        return end;
    };
    /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    NxPaginationUtils.prototype.getStartArray = /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    function (currentPage, totalPages) {
        /** @type {?} */
        var counterPages = 0;
        /** @type {?} */
        var start = [];
        /** @type {?} */
        var maxSizeArray = 3;
        while (counterPages < maxSizeArray && counterPages < totalPages) {
            /** @type {?} */
            var startItem = counterPages === 2 && currentPage > 5 ?
                this.createPaginationItem(this._elipsisText, counterPages, true) :
                this.createPaginationItem(counterPages + 1, counterPages + 1, true);
            start.push(startItem);
            counterPages++;
        }
        return start;
    };
    /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    NxPaginationUtils.prototype.getMobilePages = /**
     * @param {?} currentPage
     * @param {?} totalPages
     * @return {?}
     */
    function (currentPage, totalPages) {
        var _this = this;
        // if we have less pages than the number we want to display take all
        if (totalPages < this._pagesMobile) {
            return Array.from(Array(totalPages).keys()).map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return _this.createPaginationItem(item + 1, item + 1); }));
        }
        switch (currentPage) {
            // first page active
            case 1:
                return [1, 2, 3].map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return _this.createPaginationItem(item, item); }));
            // last page active
            case totalPages:
                return [totalPages - 2, totalPages - 1, totalPages].map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return _this.createPaginationItem(item, item); }));
            // any other page active
            default:
                return [currentPage - 1, currentPage, currentPage + 1].map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return _this.createPaginationItem(item, item); }));
        }
    };
    /**
     * @private
     * @param {?} label
     * @param {?} value
     * @param {?=} classExpanded
     * @return {?}
     */
    NxPaginationUtils.prototype.createPaginationItem = /**
     * @private
     * @param {?} label
     * @param {?} value
     * @param {?=} classExpanded
     * @return {?}
     */
    function (label, value, classExpanded) {
        return { label: label, value: value, class: classExpanded ? this._classExpanded : '' };
    };
    NxPaginationUtils.decorators = [
        { type: Injectable }
    ];
    return NxPaginationUtils;
}());
export { NxPaginationUtils };
if (false) {
    /**
     * @type {?}
     * @private
     */
    NxPaginationUtils.prototype._pagesMobile;
    /**
     * @type {?}
     * @private
     */
    NxPaginationUtils.prototype._elipsisText;
    /**
     * @type {?}
     * @private
     */
    NxPaginationUtils.prototype._classExpanded;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnaW5hdGlvbi11dGlscy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGxpYW56L25neC1uZGJ4LyIsInNvdXJjZXMiOlsicGFnaW5hdGlvbi9wYWdpbmF0aW9uLXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7QUFJM0M7SUFBQTtRQUVVLGlCQUFZLEdBQUcsQ0FBQyxDQUFDO1FBQ2pCLGlCQUFZLEdBQVcsS0FBSyxDQUFDO1FBQzdCLG1CQUFjLEdBQVcsZUFBZSxDQUFDO0lBMkZuRCxDQUFDOzs7Ozs7SUF6RkMsb0NBQVE7Ozs7O0lBQVIsVUFBUyxXQUFtQixFQUFFLFVBQWtCOztZQUUxQyxLQUFLLEdBQUcsRUFBRTs7WUFDVixLQUFLLEdBQUcsRUFBRTs7WUFBRSxNQUFNLEdBQUcsRUFBRTs7WUFBRSxHQUFHLEdBQUcsRUFBRTtRQUVyQyx1QkFBdUI7UUFDdkIsS0FBSyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQ3BELHlCQUF5QjtRQUN6QixNQUFNLEdBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxXQUFXLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDdkQscUJBQXFCO1FBQ3JCLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQztRQUVoRCxLQUFLLG9CQUFRLEtBQUssRUFBSyxNQUFNLEVBQUssR0FBRyxDQUFFLENBQUM7UUFFeEMsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDOzs7Ozs7SUFFRCwwQ0FBYzs7Ozs7SUFBZCxVQUFlLFdBQW1CLEVBQUUsVUFBa0I7O1lBQ2hELFVBQVUsR0FBRyxXQUFXLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsR0FBRyxDQUFDOztZQUNoRCxNQUFNLEdBQUcsRUFBRTtRQUVqQixPQUNF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QUMsQ0FBQyxHQUFHOzs7O2dCQUFFLFVBQUEsSUFBSSxJQUFJLE9BQUEsS0FBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBckMsQ0FBcUMsRUFBQyxDQUFDO1lBQ3ZFLG1CQUFtQjtZQUNuQixLQUFLLFVBQVU7Z0JBQ2IsT0FBTyxDQUFDLFVBQVUsR0FBRyxDQUFDLEVBQUUsVUFBVSxHQUFHLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxHQUFHOzs7O2dCQUFFLFVBQUEsSUFBSSxJQUFJLE9BQUEsS0FBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBckMsQ0FBcUMsRUFBQyxDQUFDO1lBQzFHLHdCQUF3QjtZQUN4QjtnQkFDRSxPQUFPLENBQUMsV0FBVyxHQUFHLENBQUMsRUFBRSxXQUFXLEVBQUUsV0FBVyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUc7Ozs7Z0JBQUUsVUFBQSxJQUFJLElBQUksT0FBQSxLQUFJLENBQUMsb0JBQW9CLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFyQyxDQUFxQyxFQUFDLENBQUM7U0FDOUc7SUFDSCxDQUFDOzs7Ozs7OztJQUVPLGdEQUFvQjs7Ozs7OztJQUE1QixVQUE2QixLQUFzQixFQUFFLEtBQWEsRUFBRSxhQUF1QjtRQUN6RixPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRyxDQUFDO0lBQzFGLENBQUM7O2dCQTdGRixVQUFVOztJQStGWCx3QkFBQztDQUFBLEFBL0ZELElBK0ZDO1NBOUZZLGlCQUFpQjs7Ozs7O0lBQzVCLHlDQUF5Qjs7Ozs7SUFDekIseUNBQXFDOzs7OztJQUNyQywyQ0FBaUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBQYWdlIH0gZnJvbSAnLi9wYWdpbmF0aW9uLmNvbXBvbmVudCc7XG5cbi8qKiBAZG9jcy1wcml2YXRlICovXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgTnhQYWdpbmF0aW9uVXRpbHMgIHtcbiAgcHJpdmF0ZSBfcGFnZXNNb2JpbGUgPSAzO1xuICBwcml2YXRlIF9lbGlwc2lzVGV4dDogc3RyaW5nID0gJy4uLic7XG4gIHByaXZhdGUgX2NsYXNzRXhwYW5kZWQ6IHN0cmluZyA9ICdleHBhbmRlZC12aWV3JztcblxuICBnZXRQYWdlcyhjdXJyZW50UGFnZTogbnVtYmVyLCB0b3RhbFBhZ2VzOiBudW1iZXIpOiBQYWdlW10ge1xuXG4gICAgbGV0IHBhZ2VzID0gW107XG4gICAgbGV0IHN0YXJ0ID0gW10sIG1pZGRsZSA9IFtdLCBlbmQgPSBbXTtcblxuICAgIC8vIEZpcnN0IGFycmF5IC0+IHN0YXJ0XG4gICAgc3RhcnQgPSB0aGlzLmdldFN0YXJ0QXJyYXkoY3VycmVudFBhZ2UsIHRvdGFsUGFnZXMpO1xuICAgIC8vIFNlY29uZCBhcnJheSAtPiBtaWRkbGVcbiAgICBtaWRkbGUgPSAgdGhpcy5nZXRNaWRkbGVBcnJheShjdXJyZW50UGFnZSwgdG90YWxQYWdlcyk7XG4gICAgLy8gVGhpcmQgYXJyYXkgLT4gZW5kXG4gICAgZW5kID0gdGhpcy5nZXRFbmRBcnJheShjdXJyZW50UGFnZSwgdG90YWxQYWdlcyk7XG5cbiAgICBwYWdlcyA9IFsgLi4uc3RhcnQsIC4uLm1pZGRsZSwgLi4uZW5kIF07XG5cbiAgICByZXR1cm4gcGFnZXM7XG4gIH1cblxuICBnZXRNaWRkbGVBcnJheShjdXJyZW50UGFnZTogbnVtYmVyLCB0b3RhbFBhZ2VzOiBudW1iZXIpOiBBcnJheTxhbnk+IHtcbiAgICBsZXQgcGFnZU51bWJlciA9IGN1cnJlbnRQYWdlIDwgNiA/IDQgOiBjdXJyZW50UGFnZSAtIDE7XG4gICAgY29uc3QgbWlkZGxlID0gW107XG5cbiAgICB3aGlsZSAoXG4gICAgICBtaWRkbGUubGVuZ3RoIDwgMyAmJlxuICAgICAgcGFnZU51bWJlciA+PSAyICYmXG4gICAgICBwYWdlTnVtYmVyIDw9IHRvdGFsUGFnZXMgLSAzICYmXG4gICAgICAocGFnZU51bWJlciA8PSBjdXJyZW50UGFnZSArIDEgJiYgcGFnZU51bWJlciA+PSBjdXJyZW50UGFnZSAtIDEpXG4gICAgKSB7XG4gICAgICBtaWRkbGUucHVzaCh0aGlzLmNyZWF0ZVBhZ2luYXRpb25JdGVtKHBhZ2VOdW1iZXIsIHBhZ2VOdW1iZXIpKTtcbiAgICAgIHBhZ2VOdW1iZXIrKztcbiAgICB9XG4gICAgcmV0dXJuIG1pZGRsZTtcbiAgfVxuICBnZXRFbmRBcnJheShjdXJyZW50UGFnZTogbnVtYmVyLCB0b3RhbFBhZ2VzOiBudW1iZXIpOiBBcnJheTxhbnk+IHtcbiAgICBjb25zdCBlbmQgPSBbXTtcbiAgICBsZXQgY3VycmVudEl0ZW1Ub1Nob3c6IG51bWJlciA9XG4gICAgICB0b3RhbFBhZ2VzIDw9IDMgPyB0b3RhbFBhZ2VzICsgMSA6XG4gICAgICB0b3RhbFBhZ2VzIDw9IDYgPyB0b3RhbFBhZ2VzIC0gKHRvdGFsUGFnZXMgLSA0KSA6IHRvdGFsUGFnZXMgLSAyIDtcbiAgICBjb25zdCBzaG93RWxsaXBzaXMgPSBjdXJyZW50UGFnZSA8IHRvdGFsUGFnZXMgLSA0O1xuXG4gICAgd2hpbGUgKGN1cnJlbnRJdGVtVG9TaG93IDw9IHRvdGFsUGFnZXMpIHtcbiAgICAgIGNvbnN0IGVuZEl0ZW0gPSBlbmQubGVuZ3RoID09PSAwICYmIHNob3dFbGxpcHNpcyA/XG4gICAgICAgIHRoaXMuY3JlYXRlUGFnaW5hdGlvbkl0ZW0odGhpcy5fZWxpcHNpc1RleHQsIGN1cnJlbnRJdGVtVG9TaG93LCB0cnVlKSA6XG4gICAgICAgIHRoaXMuY3JlYXRlUGFnaW5hdGlvbkl0ZW0oY3VycmVudEl0ZW1Ub1Nob3cgLCBjdXJyZW50SXRlbVRvU2hvdywgdHJ1ZSk7XG4gICAgICBlbmQucHVzaChlbmRJdGVtKTtcbiAgICAgIGN1cnJlbnRJdGVtVG9TaG93Kys7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVuZDtcbiAgfVxuICBnZXRTdGFydEFycmF5KGN1cnJlbnRQYWdlOiBudW1iZXIsIHRvdGFsUGFnZXM6IG51bWJlcik6IEFycmF5PGFueT4ge1xuICAgIGxldCBjb3VudGVyUGFnZXMgPSAwO1xuICAgIGNvbnN0IHN0YXJ0ID0gW107XG4gICAgY29uc3QgbWF4U2l6ZUFycmF5ID0gMztcblxuICAgIHdoaWxlIChjb3VudGVyUGFnZXMgPCBtYXhTaXplQXJyYXkgJiYgY291bnRlclBhZ2VzIDwgdG90YWxQYWdlcykge1xuICAgICAgY29uc3Qgc3RhcnRJdGVtID0gY291bnRlclBhZ2VzID09PSAyICYmIGN1cnJlbnRQYWdlID4gNSA/XG4gICAgICAgIHRoaXMuY3JlYXRlUGFnaW5hdGlvbkl0ZW0odGhpcy5fZWxpcHNpc1RleHQsIGNvdW50ZXJQYWdlcywgdHJ1ZSkgOlxuICAgICAgICB0aGlzLmNyZWF0ZVBhZ2luYXRpb25JdGVtKGNvdW50ZXJQYWdlcyArIDEgLCBjb3VudGVyUGFnZXMgKyAxLCB0cnVlKTtcblxuICAgICAgc3RhcnQucHVzaChzdGFydEl0ZW0pO1xuICAgICAgY291bnRlclBhZ2VzKys7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YXJ0O1xuICB9XG5cbiAgZ2V0TW9iaWxlUGFnZXMoY3VycmVudFBhZ2U6IG51bWJlciwgdG90YWxQYWdlczogbnVtYmVyKTogQXJyYXk8YW55PiB7XG4gICAgLy8gaWYgd2UgaGF2ZSBsZXNzIHBhZ2VzIHRoYW4gdGhlIG51bWJlciB3ZSB3YW50IHRvIGRpc3BsYXkgdGFrZSBhbGxcbiAgICBpZiAodG90YWxQYWdlcyA8IHRoaXMuX3BhZ2VzTW9iaWxlKSB7XG4gICAgICByZXR1cm4gQXJyYXkuZnJvbShBcnJheSh0b3RhbFBhZ2VzKS5rZXlzKCkpLm1hcChpdGVtID0+IHRoaXMuY3JlYXRlUGFnaW5hdGlvbkl0ZW0oaXRlbSArIDEsIGl0ZW0gKyAxKSk7XG4gICAgfVxuXG4gICAgc3dpdGNoIChjdXJyZW50UGFnZSkge1xuICAgICAgLy8gZmlyc3QgcGFnZSBhY3RpdmVcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgcmV0dXJuIFsxLCAyLCAzXS5tYXAoIGl0ZW0gPT4gdGhpcy5jcmVhdGVQYWdpbmF0aW9uSXRlbShpdGVtLCBpdGVtKSk7XG4gICAgICAvLyBsYXN0IHBhZ2UgYWN0aXZlXG4gICAgICBjYXNlIHRvdGFsUGFnZXM6XG4gICAgICAgIHJldHVybiBbdG90YWxQYWdlcyAtIDIsIHRvdGFsUGFnZXMgLSAxLCB0b3RhbFBhZ2VzXS5tYXAoIGl0ZW0gPT4gdGhpcy5jcmVhdGVQYWdpbmF0aW9uSXRlbShpdGVtLCBpdGVtKSk7XG4gICAgICAvLyBhbnkgb3RoZXIgcGFnZSBhY3RpdmVcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBbY3VycmVudFBhZ2UgLSAxLCBjdXJyZW50UGFnZSwgY3VycmVudFBhZ2UgKyAxXS5tYXAoIGl0ZW0gPT4gdGhpcy5jcmVhdGVQYWdpbmF0aW9uSXRlbShpdGVtLCBpdGVtKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVQYWdpbmF0aW9uSXRlbShsYWJlbDogc3RyaW5nIHwgbnVtYmVyLCB2YWx1ZTogbnVtYmVyLCBjbGFzc0V4cGFuZGVkPzogYm9vbGVhbikge1xuICAgIHJldHVybiB7IGxhYmVsOiBsYWJlbCwgdmFsdWU6IHZhbHVlLCBjbGFzczogY2xhc3NFeHBhbmRlZCA/IHRoaXMuX2NsYXNzRXhwYW5kZWQgOiAnJyAgfTtcbiAgfVxuXG59XG4iXX0=