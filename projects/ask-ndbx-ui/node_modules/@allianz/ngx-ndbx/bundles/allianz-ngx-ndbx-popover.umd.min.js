!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("@angular/core"),require("@angular/cdk/coercion"),require("@angular/cdk/overlay"),require("@angular/cdk/portal"),require("@angular/platform-browser"),require("rxjs"),require("rxjs/operators"),require("@angular/cdk/a11y"),require("@angular/cdk/keycodes"),require("@angular/common"),require("@angular/cdk/platform"),require("@allianz/ngx-ndbx/icon")):"function"==typeof define&&define.amd?define("@allianz/ngx-ndbx/popover",["exports","@angular/core","@angular/cdk/coercion","@angular/cdk/overlay","@angular/cdk/portal","@angular/platform-browser","rxjs","rxjs/operators","@angular/cdk/a11y","@angular/cdk/keycodes","@angular/common","@angular/cdk/platform","@allianz/ngx-ndbx/icon"],o):o(((e=e||self).allianz=e.allianz||{},e.allianz["ngx-ndbx"]=e.allianz["ngx-ndbx"]||{},e.allianz["ngx-ndbx"].popover={}),e.ng.core,e.ng.cdk.coercion,e.ng.cdk.overlay,e.ng.cdk.portal,e.ng.platformBrowser,e.rxjs,e.rxjs.operators,e.ng.cdk.a11y,e.ng.cdk.keycodes,e.ng.common,e.ng.cdk.platform,e.allianz["ngx-ndbx"].icon)}(this,function(e,o,t,r,n,i,s,a,p,l,c,d,h){"use strict";function u(e,o){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,n,i=t.call(e),s=[];try{for(;(void 0===o||o-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return s}var f=function(){function e(e){this._template=e}return e.decorators=[{type:o.Directive,args:[{selector:"ng-template[nxPopoverContent]"}]}],e.ctorParameters=function(){return[{type:o.TemplateRef}]},e}();var v=function(){function e(){this.closed=new o.EventEmitter,this.closeButtonClick=new s.Subject,this.showCloseButton=!1,this.arrowStyle={}}return e.prototype.ngOnDestroy=function(){this.closed.complete()},e.prototype.emitCloseButtonClick=function(){this.closeButtonClick.next()},e.prototype._onCloseKeyup=function(e){!e||e.keyCode!==l.ENTER&&e.keyCode!==l.SPACE||this.emitCloseButtonClick(),e.preventDefault()},e.prototype.emitClosedEvent=function(){this.closed.emit()},Object.defineProperty(e.prototype,"classList",{get:function(){if(this.direction)return["nx-popover--"+this.direction]},enumerable:!0,configurable:!0}),e.prototype._onClick=function(e){e.stopPropagation()},e.decorators=[{type:o.Component,args:[{selector:"nx-popover",template:'<ng-template>\n  <div [ngClass]="classList" role="tooltip" aria-hidden="false" (click)="_onClick($event)">\n    <div class="nx-popover__content" tabindex="0">\n        <div class="nx-popover__arrow" [ngStyle]="arrowStyle">\n          </div>\n      <span\n          aria-label="close"\n          tabindex="0"\n          role="button"\n          class="nx-popover__close-icon"\n          (click)="emitCloseButtonClick()"\n          (keyup)="_onCloseKeyup($event)"\n          *ngIf="showCloseButton">\n        <nx-icon aria-hidden="true" name="close"></nx-icon>\n        </span>\n\n      <span [id]="id">\n        <ng-content></ng-content>\n        <ng-container [ngTemplateOutlet]="_lazyContent?._template"></ng-container>\n      </span>\n    </div>\n  </div>\n</ng-template>\n',changeDetection:o.ChangeDetectionStrategy.OnPush,exportAs:"nxPopover",styles:[".nx-popover__content{font-size:16px;font-size:var(--popover-content-font-size,16px);line-height:24px;line-height:var(--popover-content-line-height,24px);font-weight:400;font-weight:var(--popover-content-font-weight,400);letter-spacing:0;letter-spacing:var(--popover-content-letter-spacing,0);background-color:#fff;background-color:var(--popover-background-color,#fff);color:#414141;color:var(--popover-text-color,#414141);border:1px solid #d9d9d9;border:1px solid var(--popover-border-color,#d9d9d9);border-radius:4px;box-shadow:0 2px 4px rgba(65,65,65,.5);padding:23px;display:inline-block}.nx-popover__content:focus{outline:0}.nx-popover__content::-moz-focus-inner{border:0}.nx-popover__close-icon{display:flex;position:absolute;top:4px;right:4px;cursor:pointer;font-size:16px;font-size:var(--popover-close-icon-size,16px);color:#d9d9d9;color:var(--popover-close-icon-color,#d9d9d9);border-radius:2px}.nx-popover__close-icon:focus{outline:0}.nx-popover__close-icon::-moz-focus-inner{border:0}::ng-deep [data-whatinput=keyboard] .nx-popover__close-icon:focus,::ng-deep [data-whatinput=keyboard] .nx-popover__content:focus{box-shadow:0 0 0 2px #fff,0 0 0 6px #009de6;box-shadow:var(--focus-box-shadow,0 0 0 2px #fff,0 0 0 6px #009de6)}@media screen and (-ms-high-contrast:active){::ng-deep [data-whatinput=keyboard] .nx-popover__close-icon:focus,::ng-deep [data-whatinput=keyboard] .nx-popover__content:focus{box-shadow:0 0 0 2px background,0 0 0 6px windowText}}.nx-popover__arrow{width:12px;height:12px;background-color:inherit;position:absolute;transform:translate(-50%,0);border-top:1px solid #d9d9d9;border-top:1px solid var(--popover-border-color,#d9d9d9);border-left:1px solid #d9d9d9;border-left:1px solid var(--popover-border-color,#d9d9d9)}.nx-popover--top .nx-popover__arrow{transform:translate(-50%,0) rotate(225deg);bottom:-5px;box-shadow:2px 2px 1px 1px #fff,-2px -2px 4px rgba(65,65,65,.5);box-shadow:2px 2px 1px 1px var(--popover-background-color,#fff),-2px -2px 4px rgba(65,65,65,.5)}.nx-popover--right .nx-popover__arrow{transform:translate(0,-50%) rotate(-45deg);left:-5px}.nx-popover--bottom .nx-popover__arrow{transform:translate(-50%,0) rotate(45deg);top:-5px}.nx-popover--left .nx-popover__arrow{transform:translate(0,-50%) rotate(135deg);right:-5px}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={templateRef:[{type:o.ViewChild,args:[o.TemplateRef,{static:!1}]}],_lazyContent:[{type:o.ContentChild,args:[f,{static:!1}]}],closed:[{type:o.Output,args:["nxClosed"]}]},e}();var g=0,y=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetX:0,offsetY:16},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",offsetX:0,offsetY:-16},{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetX:0,offsetY:16},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top",offsetX:0,offsetY:16},{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:16,offsetY:0},{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:-16,offsetY:0},{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetX:0,offsetY:-16},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",offsetX:0,offsetY:-16}],b=function(){function e(e,t,r,n,i,p,c,d,h){var u=this;this.overlay=e,this.elementRef=t,this.viewContainerRef=r,this.eventManager=n,this._focusTrapFactory=i,this._focusMonitor=p,this._ngZone=c,this._platform=d,this._document=h,this._destroyed=new s.Subject,this._show=!1,this._closeable=null,this._elementFocusedBeforePopoverWasOpened=null,this._manualListeners=new Map,this.id="nx-popover-"+g++,this.changeShow=new o.EventEmitter,this._closeOnClickOutside=!0,this.direction="right",this.popoverInitialVisible=!1,this.visibleChange=new o.EventEmitter,this.modal=!1,this.trigger="click",this.scrollStrategy="close",this._documentClickObservable=s.fromEvent(document,"click");var f=t.nativeElement;this._platform.IOS||this._platform.ANDROID?this._manualListeners.set("touchstart",function(){"hover"===u.trigger&&(u.show=!0)}):this._manualListeners.set("mouseenter",function(){"hover"===u.trigger&&(u.show=!0)}).set("mouseleave",function(){"hover"===u.trigger&&(u.show=!1)}).set("keydown",function(e){switch(e.keyCode){case l.SPACE:case l.ENTER:u.handleClick();break;default:return}}),this._manualListeners.forEach(function(e,o){return f.addEventListener(o,e)}),this._focusMonitor.monitor(f).pipe(a.takeUntil(this._destroyed)).subscribe(function(e){"keyboard"===e&&"hover"===u.trigger&&u._ngZone.run(function(){return u.show=!0})})}return Object.defineProperty(e.prototype,"show",{get:function(){return this._show},set:function(e){e=t.coerceBooleanProperty(e),this._show!==e&&(this._show=e,this._show?this.openPopover():this.closePopover())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closeable",{get:function(){return this._closeable},set:function(e){this._closeable=t.coerceBooleanProperty(e),this.popover&&(this.popover.showCloseButton=this.isCloseable())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closeOnClickOutside",{get:function(){return this._closeOnClickOutside},set:function(e){this._closeOnClickOutside=t.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.popover.showCloseButton=this.isCloseable()},e.prototype.ngAfterViewInit=function(){var e=this;this.popover.id=this.id,this.eventManager.addGlobalEventListener("window","keyup.esc",function(){e.isOpen&&(e.show=!1)}),this.popover.closeButtonClick.pipe(a.takeUntil(this._destroyed)).subscribe(function(){e.show=!1}),(this.popoverInitialVisible||this._show)&&(this.show=!0)},e.prototype.ngOnDestroy=function(){var e=this;this.show=!1,this._manualListeners.forEach(function(o,t){e.elementRef.nativeElement.removeEventListener(t,o)}),this._manualListeners.clear(),this._destroyed.next(),this._destroyed.complete()},Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.overlayRef&&this.createOverlay().hasAttached()},enumerable:!0,configurable:!0}),e.prototype.isCloseable=function(){return"click"===this.trigger&&null===this._closeable||this._closeable},e.prototype.updatePosition=function(){this._positionStrategy&&this._positionStrategy.apply()},e.prototype.handleClick=function(){"click"===this.trigger?this.show=!this.isOpen:"hover"===this.trigger&&(this.show=!0)},e.prototype.open=function(){this.show=!0},e.prototype.close=function(){this.show=!1},e.prototype.toggle=function(){this.show=!this.show},e.prototype.openPopover=function(){if(!this.createOverlay().hasAttached()){this._embeddedViewRef=this.createOverlay().attach(this.portal);var e=this._embeddedViewRef.rootNodes[0];this._focusTrap=this._focusTrapFactory.create(e),this._elementFocusedBeforePopoverWasOpened=this.elementRef.nativeElement,this._autoFocusFirstTabbableElement(e),this.shouldReactOnClickOutside()&&this.waitForClose()}},e.prototype._autoFocusFirstTabbableElement=function(e){this._focusTrap.focusInitialElementWhenReady().then(function(o){o||e.focus()})},e.prototype.shouldReactOnClickOutside=function(){return!this.modal&&this.closeOnClickOutside},e.prototype.closePopover=function(){this.overlayRef&&(this._returnFocusAfterPopover(),this.overlayRef.detach(),this._embeddedViewRef=null,this._focusTrap.destroy())},e.prototype.createOverlay=function(){if(!this.overlayRef){this.portal=new n.TemplatePortal(this.popover.templateRef,this.viewContainerRef);var e=new r.OverlayConfig;e.positionStrategy=this.getPosition(),this._positionStrategy=e.positionStrategy,"reposition"===this.scrollStrategy?e.scrollStrategy=this.overlay.scrollStrategies.reposition():e.scrollStrategy=this.overlay.scrollStrategies.close(),e.scrollStrategy.enable(),this.modal&&"click"===this.trigger&&(e.hasBackdrop=!0),this.overlayRef=this.overlay.create(e),this.subscribeToPositions(e.positionStrategy),this._subscribeToAttach(),this._subscribeToDetach(),this.modal&&this._subscribeToBackdropClick()}return this.overlayRef},e.prototype.subscribeToPositions=function(e){var o=this;e.positionChanges.pipe(a.takeUntil(this._destroyed)).subscribe(function(e){var t=e.connectionPair;o.positionOverlay(t),o.positionArrow(t),o._embeddedViewRef&&!o._embeddedViewRef.destroyed&&o._embeddedViewRef.detectChanges()})},e.prototype._subscribeToBackdropClick=function(){var e=this;this.overlayRef.backdropClick().pipe(a.takeUntil(this._destroyed)).subscribe(function(o){e.show=!1})},e.prototype._subscribeToDetach=function(){var e=this;this.overlayRef.detachments().pipe(a.takeUntil(this._destroyed)).subscribe(function(o){e.show&&(e.show=!1),e.changeShow.emit(e._show),e.popover.emitClosedEvent()})},e.prototype._subscribeToAttach=function(){var e=this;this.overlayRef.attachments().pipe(a.takeUntil(this._destroyed)).subscribe(function(o){e.changeShow.emit(e._show)})},e.prototype.waitForClose=function(){var e=this;return this._documentClickObservable.pipe(a.map(function(e){return e.target}),a.filter(function(o){return!e.elementRef.nativeElement.contains(o)}),a.takeUntil(this.popover.closed)).subscribe(function(){e.show=!1})},e.prototype.positionOverlay=function(e){"end"===e.originX&&"start"===e.overlayX?this.popover.direction="right":"bottom"===e.originY&&"top"===e.overlayY?this.popover.direction="bottom":"start"===e.originX&&"end"===e.overlayX?this.popover.direction="left":"top"===e.originY&&"bottom"===e.overlayY&&(this.popover.direction="top")},e.prototype.positionArrow=function(e){var o=this.elementRef.nativeElement.getBoundingClientRect().left+this.elementRef.nativeElement.getBoundingClientRect().width/2-(this.overlayRef.overlayElement.parentElement.offsetLeft+this.overlayRef.overlayElement.offsetLeft);if(e.originX===e.overlayX){var t={};t.left=o+"px",this.popover.arrowStyle=t}"bottom"!==e.originY&&"top"!==e.originY||"center"!==e.overlayX||(this.popover.arrowStyle={left:o+"px"}),"end"!==e.originX&&"start"!==e.originX||"center"!==e.overlayY||(this.popover.arrowStyle={top:"50%"})},e.prototype.getPosition=function(){var e,o=0,t=0;return"top"===this.direction?(e=[{overlayX:"center",overlayY:"bottom",originX:"center",originY:"top"}],o=0,t=-20):"right"===this.direction?(e=[{overlayX:"start",overlayY:"center",originX:"end",originY:"center"}],o=20,t=0):"bottom"===this.direction?(e=[{overlayX:"center",overlayY:"top",originX:"center",originY:"bottom"}],o=0,t=20):"left"===this.direction&&(e=[{overlayX:"end",overlayY:"center",originX:"start",originY:"center"}],o=-20,t=0),this.overlay.position().flexibleConnectedTo(this.elementRef).withPositions(function(){for(var e=[],o=0;o<arguments.length;o++)e=e.concat(u(arguments[o]));return e}(e,y)).withDefaultOffsetX(o).withDefaultOffsetY(t)},e.prototype._returnFocusAfterPopover=function(){var e=this._elementFocusedBeforePopoverWasOpened;e&&"function"==typeof e.focus&&e.focus()},e.decorators=[{type:o.Directive,args:[{selector:"[nxPopoverTriggerFor]",exportAs:"nxPopoverTrigger",host:{"(click)":"handleClick()","aria-haspopup":"true","[attr.aria-expanded]":"isOpen","[attr.aria-describedby]":"isOpen ? id : null"}}]}],e.ctorParameters=function(){return[{type:r.Overlay},{type:o.ElementRef},{type:o.ViewContainerRef},{type:i.EventManager},{type:p.FocusTrapFactory},{type:p.FocusMonitor},{type:o.NgZone},{type:d.Platform},{type:void 0,decorators:[{type:o.Optional},{type:o.Inject,args:[c.DOCUMENT]}]}]},e.propDecorators={changeShow:[{type:o.Output,args:["nxPopoverShowChange"]}],show:[{type:o.Input,args:["nxPopoverShow"]}],closeable:[{type:o.Input,args:["nxPopoverCloseable"]}],closeOnClickOutside:[{type:o.Input}],popover:[{type:o.Input,args:["nxPopoverTriggerFor"]}],direction:[{type:o.Input,args:["nxPopoverDirection"]}],popoverInitialVisible:[{type:o.Input,args:["nxPopoverInitialVisible"]}],visibleChange:[{type:o.Input,args:["nxPopoverVisibleChange"]}],modal:[{type:o.Input,args:["nxPopoverModal"]}],trigger:[{type:o.Input,args:["nxPopoverTrigger"]}],scrollStrategy:[{type:o.Input,args:["nxPopoverScrollStrategy"]}]},e}();var x=function(){function e(){}return e.decorators=[{type:o.NgModule,args:[{imports:[c.CommonModule,r.OverlayModule,h.NxIconModule],declarations:[b,v,f],exports:[b,v,f]}]}],e}();e.NxPopoverComponent=v,e.NxPopoverContentDirective=f,e.NxPopoverModule=x,e.NxPopoverTriggerDirective=b,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=allianz-ngx-ndbx-popover.umd.min.js.map