!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/cdk/overlay"),require("@angular/common"),require("@angular/core"),require("@angular/cdk/portal"),require("rxjs"),require("@angular/cdk/a11y"),require("@angular/cdk/keycodes"),require("rxjs/operators"),require("@angular/animations"),require("@angular/cdk/coercion"),require("@angular/cdk/bidi"),require("@angular/cdk/platform"),require("@allianz/ngx-ndbx/icon")):"function"==typeof define&&define.amd?define("@allianz/ngx-ndbx/context-menu",["exports","@angular/cdk/overlay","@angular/common","@angular/core","@angular/cdk/portal","rxjs","@angular/cdk/a11y","@angular/cdk/keycodes","rxjs/operators","@angular/animations","@angular/cdk/coercion","@angular/cdk/bidi","@angular/cdk/platform","@allianz/ngx-ndbx/icon"],e):e(((t=t||self).allianz=t.allianz||{},t.allianz["ngx-ndbx"]=t.allianz["ngx-ndbx"]||{},t.allianz["ngx-ndbx"]["context-menu"]={}),t.ng.cdk.overlay,t.ng.common,t.ng.core,t.ng.cdk.portal,t.rxjs,t.ng.cdk.a11y,t.ng.cdk.keycodes,t.rxjs.operators,t.ng.animations,t.ng.cdk.coercion,t.ng.cdk.bidi,t.ng.cdk.platform,t.allianz["ngx-ndbx"].icon)}(this,function(t,e,n,o,i,r,s,a,c,u,l,p,h,d){"use strict";function m(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return s}var x=function(){function t(t,e,n,o,i,s){this._template=t,this._componentFactoryResolver=e,this._appRef=n,this._injector=o,this._viewContainerRef=i,this._document=s,this._attached=new r.Subject}return t.prototype.attach=function(t){void 0===t&&(t={}),this._portal||(this._portal=new i.TemplatePortal(this._template,this._viewContainerRef)),this.detach(),this._outlet||(this._outlet=new i.DomPortalOutlet(this._document.createElement("div"),this._componentFactoryResolver,this._appRef,this._injector));var e=this._template.elementRef.nativeElement;e.parentNode&&e.parentNode.insertBefore(this._outlet.outletElement,e),this._portal.attach(this._outlet,t),this._attached.next()},t.prototype.detach=function(){this._portal.isAttached&&this._portal.detach()},t.prototype.ngOnDestroy=function(){this._outlet&&this._outlet.dispose()},t.decorators=[{type:o.Directive,args:[{selector:"ng-template[nxContextMenuContent]"}]}],t.ctorParameters=function(){return[{type:o.TemplateRef},{type:o.ComponentFactoryResolver},{type:o.ApplicationRef},{type:o.Injector},{type:o.ViewContainerRef},{type:void 0,decorators:[{type:o.Inject,args:[n.DOCUMENT]}]}]},t}();var g={transformContextMenu:u.trigger("transformContextMenu",[u.state("void",u.style({opacity:0,transform:"scale(0.8)"})),u.transition("void => enter",u.group([u.query(".nx-context-menu__content",u.animate("100ms linear",u.style({opacity:1}))),u.animate("120ms cubic-bezier(0, 0, 0.2, 1)",u.style({transform:"scale(1)"}))])),u.transition("* => void",u.animate("100ms linear",u.style({opacity:0})))])},f=function(){function t(t){this._ngZone=t,this._items=[],this._itemChanges=new r.Subject,this._tabSubscription=r.Subscription.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new r.Subject,this.closed=new o.EventEmitter}return t.prototype.ngAfterContentInit=function(){var t=this;this._keyManager=new s.FocusKeyManager(this._items).withWrap().withTypeAhead(),this._tabSubscription=this._keyManager.tabOut.subscribe(function(){return t.closed.emit("tab")})},t.prototype.ngOnDestroy=function(){this._tabSubscription.unsubscribe(),this.closed.complete()},t.prototype._hovered=function(){return this._itemChanges.pipe(c.startWith(this._items),c.switchMap(function(t){return r.merge.apply(void 0,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(m(arguments[e]));return t}(t.map(function(t){return t._hovered})))}))},t.prototype._handleKeydown=function(t){var e=t.keyCode,n=this._keyManager;switch(e){case a.ESCAPE:a.hasModifierKey(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case a.LEFT_ARROW:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case a.RIGHT_ARROW:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;case a.HOME:case a.END:a.hasModifierKey(t)||(e===a.HOME?n.setFirstItemActive():n.setLastItemActive(),t.preventDefault());break;default:n.onKeydown(t)}},t.prototype.focusFirstItem=function(){var t=this;this.lazyContent?this._ngZone.onStable.asObservable().pipe(c.take(1)).subscribe(function(){return t._keyManager.setFirstItemActive()}):this._keyManager.setFirstItemActive()},t.prototype.resetActiveItem=function(){this._keyManager.setActiveItem(-1)},t.prototype.addItem=function(t){-1===this._items.indexOf(t)&&(this._items.push(t),this._itemChanges.next(this._items))},t.prototype.removeItem=function(t){var e=this._items.indexOf(t);this._items.indexOf(t)>-1&&(this._items.splice(e,1),this._itemChanges.next(this._items))},t.prototype._startAnimation=function(){this._panelAnimationState="enter"},t.prototype._resetAnimation=function(){this._panelAnimationState="void"},t.prototype._onAnimationDone=function(t){this._animationDone.next(t),this._isAnimating=!1},t.prototype._onAnimationStart=function(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)},t.decorators=[{type:o.Component,args:[{selector:"nx-context-menu",template:'<ng-template>\n  <div class="nx-context-menu"\n    [ngClass]="_classList"\n    (keydown)="_handleKeydown($event)"\n    (click)="closed.emit(\'click\')"\n    [@transformContextMenu]="_panelAnimationState"\n    (@transformContextMenu.start)="_onAnimationStart($event)"\n    (@transformContextMenu.done)="_onAnimationDone($event)"\n    tabindex="-1"\n    role="menu">\n    <div class="nx-context-menu__content">\n      <ng-content></ng-content>\n    </div>\n  </div>\n</ng-template>\n',changeDetection:o.ChangeDetectionStrategy.OnPush,exportAs:"nxContextMenu",animations:[g.transformContextMenu],styles:[".nx-context-menu{border-radius:4px;background:#fff;background:var(--context-menu-background-color,#fff);min-height:64px;box-shadow:0 2px 4px rgba(65,65,65,.5);outline:0}.nx-context-menu.ng-animating{pointer-events:none}.nx-context-menu__content:not(:empty){padding-top:16px;padding-bottom:16px;display:flex;flex-direction:column}@media screen and (-ms-high-contrast:active){.nx-context-menu{border:1px solid windowText}.nx-context-menu__content:not(:empty){background-color:buttonFace}}"]}]}],t.ctorParameters=function(){return[{type:o.NgZone}]},t.propDecorators={templateRef:[{type:o.ViewChild,args:[o.TemplateRef,{static:!1}]}],lazyContent:[{type:o.ContentChild,args:[x,{static:!1}]}],closed:[{type:o.Output}]},t}();var _=function(){function t(t,e,n,o){this._elementRef=t,this._changeDetectorRef=n,this._parentMenu=o,this._hovered=new r.Subject,this._disabled=!1,this._highlighted=!1,this._triggersSubmenu=!1,o&&o.addItem&&o.addItem(this),this._document=e}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=l.coerceBooleanProperty(t),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._getHostElement().focus()},t.prototype.ngOnDestroy=function(){this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete()},t.prototype._getTabIndex=function(){return this.disabled?"-1":"0"},t.prototype._getHostElement=function(){return this._elementRef.nativeElement},t.prototype._checkDisabled=function(t){this.disabled&&(t.preventDefault(),t.stopPropagation())},t.prototype._handleMouseEnter=function(){this._hovered.next(this)},t.prototype.getLabel=function(){var t=this._elementRef.nativeElement,e=this._document?this._document.TEXT_NODE:3,n="";if(t.childNodes)for(var o=t.childNodes.length,i=0;i<o;i++)t.childNodes[i].nodeType===e&&(n+=t.childNodes[i].textContent);return n.trim()},t.decorators=[{type:o.Component,args:[{selector:"[nxContextMenuItem]",exportAs:"nxContextMenuItem",host:{class:"nx-context-menu-item",role:"menuitem","[class.is-highlighted]":"_highlighted","[attr.tabindex]":"_getTabIndex()","[attr.aria-disabled]":"disabled.toString()","[attr.disabled]":"disabled || null","(mouseenter)":"_handleMouseEnter()","(click)":"_checkDisabled($event)"},changeDetection:o.ChangeDetectionStrategy.OnPush,template:'\n    <ng-content></ng-content>\n    <nx-icon *ngIf="_triggersSubmenu"\n      class="nx-context-menu-item__expand"\n      name="chevron-right-small">\n    </nx-icon>\n    ',styles:[":host{font-size:16px;font-size:var(--context-menu-font-size,16px);line-height:24px;line-height:var(--context-menu-line-height,24px);font-weight:400;font-weight:var(--context-menu-font-weight,400);letter-spacing:0;letter-spacing:var(--context-menu-letter-spacing,0);display:flex;align-items:center;cursor:pointer;text-align:left;width:100%;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;outline:0;background:0 0;padding:4px 48px 4px 32px;color:#414141;color:var(--context-menu-item-text-color,#414141)}:host:not(:disabled).is-highlighted,:host:not(:disabled):active,:host:not(:disabled):hover{color:#006192;color:var(--context-menu-item-active-color,#006192)}@media screen and (-ms-high-contrast:active){:host{-ms-high-contrast-adjust:none;background-color:buttonFace;color:buttonText}:host:not(:disabled).is-highlighted,:host:not(:disabled):active,:host:not(:disabled):hover{background-color:highlight;color:highlightText}}:host:disabled{cursor:not-allowed;color:#c2c2c2;color:var(--context-menu-item-disabled-color,#c2c2c2)}:host::-moz-focus-inner{border:0}:host ::ng-deep>nx-icon{margin-right:8px;font-size:20px;font-size:var(--context-menu-item-icon-size,20px)}:host .nx-context-menu-item__expand{font-size:20px;font-size:var(--context-menu-item-expand-icon-size,20px);padding-left:8px;margin-left:auto;margin-right:-16px;width:1em}:host-context([data-whatinput=keyboard]):focus{border-radius:8px;outline:0;box-shadow:inset 0 0 0 4px #009de6,inset 0 0 0 6px #fff;box-shadow:var(--focus-inset-box-shadow,inset 0 0 0 4px #009de6,inset 0 0 0 6px #fff)}@media screen and (-ms-high-contrast:active){:host:disabled{color:GrayText}:host-context([data-whatinput=keyboard]):focus{box-shadow:inset 0 0 0 4px windowText,inset 0 0 0 6px background}}"]}]}],t.ctorParameters=function(){return[{type:o.ElementRef},{type:void 0,decorators:[{type:o.Inject,args:[n.DOCUMENT]}]},{type:o.ChangeDetectorRef},{type:f,decorators:[{type:o.Inject,args:[f]},{type:o.Optional}]}]},t.propDecorators={disabled:[{type:o.Input}]},t}();h.normalizePassiveListenerOptions({passive:!0});var y=function(){function t(t,e,n,i,s,a){this._overlay=t,this._element=e,this._viewContainerRef=n,this._parentMenu=i,this._contextMenuItemInstance=s,this._dir=a,this._overlayRef=null,this._contextMenuOpen=!1,this._closingActionsSubscription=r.Subscription.EMPTY,this._hoverSubscription=r.Subscription.EMPTY,this._contextMenuCloseSubscription=r.Subscription.EMPTY,this.contextMenuOpened=new o.EventEmitter,this.contextMenuClosed=new o.EventEmitter,s&&(s._triggersSubmenu=this.triggersSubmenu()),this._scrollStrategy=this._overlay.scrollStrategies.reposition,this._documentClickObservable=r.fromEvent(document,"click")}return Object.defineProperty(t.prototype,"contextMenu",{get:function(){return this._contextMenu},set:function(t){var e=this;t!==this._contextMenu&&(this._contextMenu=t,this._contextMenuCloseSubscription.unsubscribe(),t&&(this._contextMenuCloseSubscription=t.closed.asObservable().subscribe(function(t){e._destroyMenu(),"click"!==t&&"tab"!==t||!e._parentMenu||e._parentMenu.closed.emit(t)})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollStrategy",{set:function(t){this._scrollStrategy="close"===t?this._overlay.scrollStrategies.close:this._overlay.scrollStrategies.reposition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextMenuOpen",{get:function(){return this._contextMenuOpen},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"},enumerable:!0,configurable:!0}),t.prototype.ngAfterContentInit=function(){this._checkContextMenu(),this._handleHover()},t.prototype.ngOnDestroy=function(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._contextMenuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()},t.prototype.triggersSubmenu=function(){return!(!this._contextMenuItemInstance||!this._parentMenu)},t.prototype.toggleContextMenu=function(){return this.contextMenuOpen?this.closeContextMenu():this.openContextMenu()},t.prototype.openContextMenu=function(){var t=this;if(!this.contextMenuOpen){this._checkContextMenu();var e=this._createOverlay(),n=e.getConfig();this._setPosition(n.positionStrategy),e.attach(this._getPortal()),this.contextMenu.lazyContent&&this.contextMenu.lazyContent.attach(this.contextMenuData),this._closingActionsSubscription=this._contextMenuClosingActions().subscribe(function(){return t.closeContextMenu()}),this._initContextMenu(),this.contextMenu instanceof f&&this.contextMenu._startAnimation(),this._waitForClose()}},t.prototype.closeContextMenu=function(){this.contextMenu.closed.emit()},t.prototype._destroyMenu=function(){var t=this;if(this._overlayRef&&this.contextMenuOpen){var e=this.contextMenu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),e._resetAnimation(),e.lazyContent?e._animationDone.pipe(c.filter(function(t){return"void"===t.toState}),c.take(1),c.takeUntil(e.lazyContent._attached)).subscribe({next:function(){return e.lazyContent&&e.lazyContent.detach()},complete:function(){return t._resetContextMenu()}}):this._resetContextMenu()}},t.prototype._initContextMenu=function(){this.contextMenu.parentMenu=this.triggersSubmenu()?this._parentMenu:void 0,this.contextMenu.direction=this.dir,this._setIsContextMenuOpen(!0),this.contextMenu.focusFirstItem()},t.prototype.focus=function(){this._element.nativeElement.focus()},t.prototype._resetContextMenu=function(){this._setIsContextMenuOpen(!1),this.focus()},t.prototype._setIsContextMenuOpen=function(t){this._contextMenuOpen=t,this._contextMenuOpen?this.contextMenuOpened.emit():this.contextMenuClosed.emit(),this.triggersSubmenu()&&(this._contextMenuItemInstance._highlighted=t)},t.prototype._checkContextMenu=function(){this.contextMenu||function(){throw Error('nxContextMenuTriggerFor: must pass in an nx-context-menu instance.\n    Example:\n      <nx-context-menu #contextMenu="nxContextMenu"></nx-context-menu>\n      <button [nxContextMenuTriggerFor]="contextMenu"></button>')}()},t.prototype._createOverlay=function(){if(!this._overlayRef){var t=this._getOverlayConfig();this._overlayRef=this._overlay.create(t),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef},t.prototype._getOverlayConfig=function(){return new e.OverlayConfig({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withFlexibleDimensions(!1).withTransformOriginOn(".nx-context-menu"),scrollStrategy:this._scrollStrategy(),direction:this._dir})},t.prototype._setPosition=function(t){var e="start",n="end",o="top",i="bottom",r=e,s=n,a=0;this.triggersSubmenu()?(s=e="end",n=r="start",a=-16):(a=8,o="bottom",i="top"),t.withPositions([{originX:e,originY:o,overlayX:r,overlayY:"top",offsetY:a},{originX:n,originY:o,overlayX:s,overlayY:"top",offsetY:a},{originX:e,originY:i,overlayX:r,overlayY:"bottom",offsetY:-a},{originX:n,originY:i,overlayX:s,overlayY:"bottom",offsetY:-a}])},t.prototype._contextMenuClosingActions=function(){var t,e,n=this;this._overlayRef&&(t=this._overlayRef.backdropClick(),e=this._overlayRef.detachments());var o=this._parentMenu?this._parentMenu.closed:r.of(),i=this._parentMenu?this._parentMenu._hovered().pipe(c.filter(function(t){return t!==n._contextMenuItemInstance}),c.filter(function(){return n._contextMenuOpen})):r.of();return r.merge(t,o,i,e)},t.prototype._handleMousedown=function(t){this.triggersSubmenu()&&t.preventDefault()},t.prototype._handleKeydown=function(t){var e=t.keyCode;this.triggersSubmenu()&&(e===a.RIGHT_ARROW&&"ltr"===this.dir||e===a.LEFT_ARROW&&"rtl"===this.dir)&&this.openContextMenu()},t.prototype._handleClick=function(t){this.triggersSubmenu()?(t.stopPropagation(),this.openContextMenu()):this.toggleContextMenu()},t.prototype._waitForClose=function(){var t=this;return this._documentClickObservable.pipe(c.map(function(t){return t.target}),c.filter(function(e){return!t._element.nativeElement.contains(e)}),c.takeUntil(this.contextMenu.closed)).subscribe(function(){t.closeContextMenu()})},t.prototype._handleHover=function(){var t=this;this.triggersSubmenu()&&(this._hoverSubscription=this._parentMenu._hovered().pipe(c.filter(function(e){return e===t._contextMenuItemInstance&&!e.disabled}),c.delay(0,r.asapScheduler)).subscribe(function(){t.contextMenu._isAnimating?t.contextMenu._animationDone.pipe(c.take(1),c.delay(0,r.asapScheduler),c.takeUntil(t._parentMenu._hovered())).subscribe(function(){return t.openContextMenu()}):t.openContextMenu()}))},t.prototype._getPortal=function(){return this._portal&&this._portal.templateRef===this.contextMenu.templateRef||(this._portal=new i.TemplatePortal(this.contextMenu.templateRef,this._viewContainerRef)),this._portal},t.decorators=[{type:o.Directive,args:[{selector:"[nxContextMenuTriggerFor]",host:{"aria-haspopup":"true","[attr.aria-expanded]":"contextMenuOpen || null","(mousedown)":"_handleMousedown($event)","(keydown)":"_handleKeydown($event)","(click)":"_handleClick($event)"},exportAs:"nxContextMenuTrigger"}]}],t.ctorParameters=function(){return[{type:e.Overlay},{type:o.ElementRef},{type:o.ViewContainerRef},{type:f,decorators:[{type:o.Optional}]},{type:_,decorators:[{type:o.Optional},{type:o.Self}]},{type:p.Directionality,decorators:[{type:o.Optional}]}]},t.propDecorators={contextMenu:[{type:o.Input,args:["nxContextMenuTriggerFor"]}],scrollStrategy:[{type:o.Input}],contextMenuData:[{type:o.Input,args:["nxContextMenuTriggerData"]}],contextMenuOpened:[{type:o.Output}],contextMenuClosed:[{type:o.Output}]},t}();var b=[f,x,_,y],v=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{imports:[n.CommonModule,e.OverlayModule,d.NxIconModule],exports:b,declarations:b}]}],t}();t.MENU_PANEL_OFFSET=8,t.MENU_PANEL_TOP_PADDING=16,t.NxContextMenuComponent=f,t.NxContextMenuItemComponent=_,t.NxContextMenuModule=v,t.NxContextMenuTriggerDirective=y,t.ɵa=g,t.ɵb=x,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=allianz-ngx-ndbx-context-menu.umd.min.js.map