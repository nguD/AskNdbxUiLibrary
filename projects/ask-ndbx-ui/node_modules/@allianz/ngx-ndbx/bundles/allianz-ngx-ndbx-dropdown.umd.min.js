!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@allianz/ngx-ndbx/formfield"),require("@allianz/ngx-ndbx/icon"),require("@angular/cdk/a11y"),require("@angular/cdk/overlay"),require("@angular/common"),require("@angular/core"),require("@allianz/ngx-ndbx/checkbox"),require("@angular/cdk/collections"),require("@angular/cdk/keycodes"),require("@angular/forms"),require("rxjs"),require("rxjs/operators"),require("@angular/cdk/observers")):"function"==typeof define&&define.amd?define("@allianz/ngx-ndbx/dropdown",["exports","@allianz/ngx-ndbx/formfield","@allianz/ngx-ndbx/icon","@angular/cdk/a11y","@angular/cdk/overlay","@angular/common","@angular/core","@allianz/ngx-ndbx/checkbox","@angular/cdk/collections","@angular/cdk/keycodes","@angular/forms","rxjs","rxjs/operators","@angular/cdk/observers"],t):t(((e=e||self).allianz=e.allianz||{},e.allianz["ngx-ndbx"]=e.allianz["ngx-ndbx"]||{},e.allianz["ngx-ndbx"].dropdown={}),e.allianz["ngx-ndbx"].formfield,e.allianz["ngx-ndbx"].icon,e.ng.cdk.a11y,e.ng.cdk.overlay,e.ng.common,e.ng.core,e.allianz["ngx-ndbx"].checkbox,e.ng.cdk.collections,e.ng.cdk.keycodes,e.ng.forms,e.rxjs,e.rxjs.operators,e.ng.cdk.observers)}(this,function(e,t,n,o,i,r,a,l,s,p,c,d,h,u){"use strict";var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function g(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function x(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}function m(){return Error("`compareWith` must be a function.")}var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiSelect=!1,t}return g(t,e),t.propDecorators={isMultiSelect:[{type:a.Input,args:["nxIsMultiselect"]}]},t}(t.NxFormfieldControl);var b=function(){function e(){}return e.decorators=[{type:a.Component,args:[{selector:"nx-dropdown-group",template:'<div class="nx-dropdown-results__group">\n  <div class="nx-dropdown-results__group-label">{{label}}</div>\n  <ng-content></ng-content>\n</div>\n',changeDetection:a.ChangeDetectionStrategy.OnPush,styles:[":host{display:block}:host:first-child .nx-dropdown-results__group{background:rgba(236,236,236,.5);background:var(--dropdown-group-section-background-color,rgba(236,236,236,.5))}:host:first-child .nx-dropdown-results__group-label{padding-top:16px}.nx-dropdown-results__group-label{font-size:12px;font-size:var(--formfield-label-font-size,12px);line-height:16px;line-height:var(--formfield-label-line-height,16px);font-weight:var(--formfield-label-font-weight,600);letter-spacing:.5px;letter-spacing:var(--formfield-label-letter-spacing,.5px);font-style:italic;font-weight:700;padding:24px 32px 16px}"]}]}],e.propDecorators={label:[{type:a.Input,args:["nxLabel"]}]},e}();var v=function(e,t){void 0===t&&(t=!1),this.item=e,this.isUserInput=t};var w=0,C=function(){function e(e,t,n,o){var i=this;this._dropdown=e,this.group=t,this._changeDetectorRef=n,this._elementRef=o,this._hidden=!1,this._mostRecentViewValue="",this._id="nx-dropdown-item-"+w++,this._selected=!1,this._destroy=new d.Subject,this.onSelectionChange=new a.EventEmitter,this._stateChanges=new d.Subject,this._dropdown.filterChanges.pipe(h.takeUntil(this._destroy)).subscribe(function(e){i._showOrHideByFilter(e)}),this._dropdown._closedStream.pipe(h.takeUntil(this._destroy)).subscribe(function(){i._hidden=!1})}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiselect",{get:function(){return this._dropdown&&this._dropdown.isMultiSelect},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewChecked=function(){if(this._selected){var e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}},e.prototype.ngOnDestroy=function(){this._stateChanges.complete(),this._destroy.next(),this._destroy.complete()},e.prototype._onClick=function(e){e.preventDefault(),e.stopPropagation(),this._selectViaInteraction()},e.prototype._selectViaInteraction=function(){this._selected=!this.multiselect||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0)},e.prototype.show=function(){this._hidden=!1,this._changeDetectorRef.markForCheck()},e.prototype.hide=function(){this._hidden=!0,this._changeDetectorRef.markForCheck()},e.prototype._showOrHideByFilter=function(e){var t=this._dropdown.filterFn(e,this.viewValue);this._hidden=!t,this._changeDetectorRef.markForCheck()},Object.defineProperty(e.prototype,"_formattedValue",{get:function(){return this._dropdown.valueFormatter(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewValue",{get:function(){return(this._elementRef.nativeElement.textContent||"").trim()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementRef",{get:function(){return this._elementRef},enumerable:!0,configurable:!0}),e.prototype.select=function(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())},e.prototype.deselect=function(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())},e.prototype.focus=function(){this._elementRef.nativeElement.focus()},e.prototype._emitSelectionChangeEvent=function(e){void 0===e&&(e=!1),this.onSelectionChange.emit(new v(this,e))},e.prototype.setActiveStyles=function(){this._active=!0,this._changeDetectorRef.markForCheck()},e.prototype.setInactiveStyles=function(){this._active=!1,this._changeDetectorRef.markForCheck()},e.prototype.getLabel=function(){return this.viewValue},e.prototype._isContentEmpty=function(e){return 0===e.children.length&&!e.textContent.trim()},e.prototype._onLabelChange=function(){this._changeDetectorRef.detectChanges()},e.decorators=[{type:a.Component,args:[{selector:"nx-dropdown-item",template:'<div #container class="nx-dropdown-results__option"\n     [ngClass]="{\'nx-dropdown-results__option--selected\': selected}">\n\n   <nx-checkbox *ngIf="multiselect" [checked]="selected">\n      <ng-container *ngTemplateOutlet="contentTemplate"></ng-container>\n    </nx-checkbox>\n\n    <span *ngIf="!multiselect" class="nx-dropdown-results__option-checkicon">\n       <nx-icon name="check" aria-hidden="true"></nx-icon>\n    </span>\n\n    <ng-container *ngIf="!multiselect">\n      <ng-container *ngTemplateOutlet="contentTemplate"></ng-container>\n    </ng-container>\n</div>\n\n<ng-template #contentTemplate>\n  <div class="nx-dropdown-results__option-label" >\n    <span #content (cdkObserveContent)="_onLabelChange()">\n      <ng-content></ng-content>\n    </span>\n    <ng-container *ngIf="_isContentEmpty(content)">\n      {{_formattedValue}}\n    </ng-container>\n  </div>\n</ng-template>\n',changeDetection:a.ChangeDetectionStrategy.OnPush,host:{"[id]":"id",role:"option","[attr.aria-selected]":"selected.toString()","[class.nx-hidden]":"_hidden","[class.nx-dropdown-item--active]":"active","[class.nx-selected]":"selected","[class.nx-multiselect]":"multiselect","(click)":"_onClick($event)"},styles:[':host{display:block}:host(.nx-hidden){display:none}:host:first-child .nx-dropdown-results__option{padding-top:16px}:host:last-child .nx-dropdown-results__option{padding-bottom:16px}nx-checkbox{margin-bottom:0}.nx-dropdown-results__option{font-size:20px;font-size:var(--dropdown-item-font-size,20px);line-height:28px;line-height:var(--dropdown-item-line-height,28px);font-weight:400;font-weight:var(--dropdown-item-font-weight,400);letter-spacing:.2px;letter-spacing:var(--dropdown-item-letter-spacing,.2px);padding:8px 32px 8px 8px;cursor:pointer;position:relative;display:flex;max-width:100%;white-space:nowrap}.nx-dropdown-results__option-label{padding:0 12px;margin:0 -12px;color:#414141;color:var(--dropdown-item-text-color,#414141);white-space:pre-line}@media screen and (-ms-high-contrast:active){.nx-dropdown-results__option-label{-ms-high-contrast-adjust:none;color:buttonText;background-color:buttonFace;border-radius:4px}}:host(.nx-multiselect) .nx-dropdown-results__option{display:block;padding-left:32px}:host(.nx-selected):hover .nx-dropdown-results__option-checkicon,:host(.nx-selected):hover .nx-dropdown-results__option-label,:host:hover .nx-dropdown-results__option-label{color:#006192;color:var(--hover-primary,#006192)}@media screen and (-ms-high-contrast:active){:host(.nx-dropdown-item--active):not(.nx-multiselect) .nx-dropdown-results__option-label,:host:hover .nx-dropdown-results__option-label{color:highlightText;background-color:highlight}:host(.nx-dropdown-item--active):not(.nx-multiselect) .nx-dropdown-results__option-checkicon{-ms-high-contrast-adjust:none;color:highlightText;background:highlight;z-index:1}}:host(.nx-selected) .nx-dropdown-results__option-checkicon{opacity:1}:host(.nx-selected) .nx-dropdown-results__option-label{color:#414141;color:var(--dropdown-item-selected-color,#414141)}.nx-dropdown-results__option-checkicon{opacity:0;margin-right:8px;height:28px;height:var(--dropdown-item-line-height,28px);color:#414141;color:var(--dropdown-item-checkmark-color,#414141)}.nx-dropdown-results__option-checkicon nx-icon{line-height:28px;line-height:var(--dropdown-item-line-height,28px);font-size:16px}\n:host-context([data-whatinput="keyboard"] .nx-dropdown__panel-body.is-stable).nx-dropdown-item--active .nx-dropdown-results__option .nx-dropdown-results__option-label {\n  border-radius: 4px;\n  box-shadow: 0 0 0 2px #ffffff, 0 0 0 6px #009DE6;\n  box-shadow: var(--focus-box-shadow, 0 0 0 2px #ffffff, 0 0 0 6px #009DE6); }\n  @media screen and (-ms-high-contrast: active) {\n    :host-context([data-whatinput="keyboard"] .nx-dropdown__panel-body.is-stable).nx-dropdown-item--active .nx-dropdown-results__option .nx-dropdown-results__option-label {\n      box-shadow: 0 0 0 2px background, 0 0 0 6px windowText; } }\n\n\n:host-context([data-whatinput="keyboard"] .nx-dropdown__panel-body.is-stable).nx-multiselect.nx-dropdown-item--active .nx-dropdown-results__option .nx-dropdown-results__option-label {\n  box-shadow: none; }\n  @media screen and (-ms-high-contrast: active) {\n    :host-context([data-whatinput="keyboard"] .nx-dropdown__panel-body.is-stable).nx-multiselect.nx-dropdown-item--active .nx-dropdown-results__option .nx-dropdown-results__option-label {\n      box-shadow: none; } }\n\n:host-context([data-whatinput="keyboard"] .nx-dropdown__panel-body.is-stable).nx-multiselect.nx-dropdown-item--active ::ng-deep .nx-checkbox__label {\n  border-radius: 4px;\n  box-shadow: 0 0 0 2px #ffffff, 0 0 0 6px #009DE6;\n  box-shadow: var(--focus-box-shadow, 0 0 0 2px #ffffff, 0 0 0 6px #009DE6); }\n  @media screen and (-ms-high-contrast: active) {\n    :host-context([data-whatinput="keyboard"] .nx-dropdown__panel-body.is-stable).nx-multiselect.nx-dropdown-item--active ::ng-deep .nx-checkbox__label {\n      box-shadow: 0 0 0 2px background, 0 0 0 6px windowText; } }\n\n:host(.nx-selected.nx-dropdown-item--active) .nx-dropdown-results__option-label{padding-left:24px;margin-left:-24px}:host ::ng-deep .nx-checkbox__label{padding:0 4px;margin:0 -4px}']}]}],e.ctorParameters=function(){return[{type:y,decorators:[{type:a.Inject,args:[y]}]},{type:b,decorators:[{type:a.Optional}]},{type:a.ChangeDetectorRef},{type:a.ElementRef}]},e.propDecorators={value:[{type:a.Input,args:["nxValue"]}],onSelectionChange:[{type:a.Output}],containerElement:[{type:a.ViewChild,args:["container",{static:!0}]}]},e}();var k=function(){function e(e){this.templateRef=e}return e.decorators=[{type:a.Directive,args:[{selector:"[nxClosedLabel]"}]}],e.ctorParameters=function(){return[{type:a.TemplateRef}]},e}();var O=function(e,t){this.source=e,this.value=t};var I=function(e){function n(t,n,o,i,r,l,s,p){var c=e.call(this)||this;return c._changeDetectorRef=t,c._elementRef=n,c._ngZone=o,c.formFieldComponent=r,c.ngControl=l,c._parentForm=s,c._parentFormGroup=p,c.readonly=!1,c._disabled=!1,c._focused=!1,c._panelOpen=!1,c.errorState=!1,c.isStable=!1,c.controlType="nx-dropdown",c._overlayViewportMargin=16,c.stateChanges=new d.Subject,c._optionIds="",c._tabIndex=0,c.currentFilter="",c._ariaLabel="",c._style="",c._negative=!1,c.showFilter=!1,c.filterPlaceholder="",c.openedChange=new a.EventEmitter,c._openedStream=c.openedChange.pipe(h.filter(function(e){return e}),h.map(function(){})),c._closedStream=c.openedChange.pipe(h.filter(function(e){return!e}),h.map(function(){})),c.filterChanges=new d.Subject,c.valueChange=new a.EventEmitter,c.selectionChange=new a.EventEmitter,c.optionSelectionChanges=d.defer(function(){return c.options?d.merge.apply(void 0,x(c.options.map(function(e){return e.onSelectionChange}))):c._ngZone.onStable.asObservable().pipe(h.take(1),h.switchMap(function(){return c.optionSelectionChanges}))}),c._destroy=new d.Subject,c.valueFormatter=function(e){return null==e?"":e.toString()},c._compareWith=function(e,t){return e===t},c._filterFn=function(e,t){return t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>=0},c._onChange=function(){},c._onTouched=function(){},c.ngControl&&(c.ngControl.valueAccessor=c),c._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"center",overlayX:"start",overlayY:"center"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],c.tabIndex=parseInt(i,10)||0,c}return g(n,e),Object.defineProperty(n.prototype,"tabIndex",{get:function(){return this.disabled?-1:this._tabIndex},set:function(e){this._tabIndex=null!=e?e:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this.writeValue(e),this._value=e,this._onChange(e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"styles",{set:function(e){this._style!==e&&(this._style=e,this._negative=!!this._style.match(/negative/))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closedDropdownLabel",{get:function(){return this._closedDropdownLabel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.isMultiSelect?this._selectionModel.selected:this._selectionModel.selected[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"panelOpen",{get:function(){return this._panelOpen},set:function(e){this._panelOpen=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"label",{get:function(){return this.formFieldComponent?this.formFieldComponent.label:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"compareWith",{get:function(){return this._compareWith},set:function(e){if("function"!=typeof e)throw m();this._compareWith=e,this._selectionModel&&this._initializeSelection()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filterFn",{get:function(){return this._filterFn},set:function(e){if("function"!=typeof e)throw m();this._filterFn=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"focused",{get:function(){return this._focused||this.panelOpen},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"elementRef",{get:function(){return this._elementRef},enumerable:!0,configurable:!0}),n.prototype.ngDoCheck=function(){this.ngControl&&this.updateErrorState()},n.prototype.ngOnInit=function(){this._selectionModel=new s.SelectionModel(this.isMultiSelect)},n.prototype.ngAfterContentInit=function(){var e=this;this._closedDropdownLabel=this._customClosedDropdownLabel&&this._customClosedDropdownLabel.templateRef||this._defaultClosedDropdownLabel,this._initKeyManager(),this._selectionModel.changed.pipe(h.takeUntil(this._destroy)).subscribe(function(e){e.added.forEach(function(e){return e.select()}),e.removed.forEach(function(e){return e.deselect()})}),this.options.changes.pipe(h.startWith(null),h.takeUntil(this._destroy)).subscribe(function(){e._resetOptions(),e._initializeSelection()})},n.prototype.ngOnDestroy=function(){this._destroy.next(),this._destroy.complete()},n.prototype.isErrorState=function(e,t){return!!(e&&e.invalid&&(e.touched||t&&t.submitted))},n.prototype.updateErrorState=function(){var e=this.errorState,t=this._parentFormGroup||this._parentForm,n=this.ngControl?this.ngControl.control:null,o=this.isErrorState(n,t);o!==e&&(this.errorState=o,this.stateChanges.next())},n.prototype._initKeyManager=function(){var e=this;this._keyManager=new o.ActiveDescendantKeyManager(this.options).withTypeAhead().withWrap().withVerticalOrientation().withHorizontalOrientation("ltr").skipPredicate(function(e){return e._hidden}),this._keyManager.tabOut.pipe(h.takeUntil(this._destroy)).subscribe(function(){e.closePanel()}),this._keyManager.change.pipe(h.takeUntil(this._destroy)).subscribe(function(){e._panelOpen&&e.panel?e._ngZone.onStable.asObservable().pipe(h.take(1)).subscribe(function(){e._scrollActiveOptionIntoView()}):e._panelOpen||e.isMultiSelect||!e._keyManager.activeItem||e._keyManager.activeItem._selectViaInteraction()})},n.prototype._resetOptions=function(){var e=this,t=d.merge(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(h.takeUntil(t)).subscribe(function(t){e._onSelect(t.item,t.isUserInput),t.isUserInput&&!e.isMultiSelect&&e._panelOpen&&e.closePanel()}),d.merge.apply(void 0,x(this.options.map(function(e){return e._stateChanges}))).pipe(h.takeUntil(t)).subscribe(function(){setTimeout(function(){e._changeDetectorRef.markForCheck(),e.stateChanges.next()})}),this._setOptionIds()},n.prototype._setOptionIds=function(){this._optionIds=this.options.map(function(e){return e.id}).join(" ")},n.prototype._onSelect=function(e,t){var n=this._selectionModel.isSelected(e);null!=e.value||this.isMultiSelect?(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e),t&&this._keyManager.setActiveItem(e),this.isMultiSelect&&this._sortValues()):(e.deselect(),this._selectionModel.clear(),this._propagateChanges(e.value)),n!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()},n.prototype._initializeSelection=function(){var e=this;Promise.resolve().then(function(){e._setSelectionByValue(e.ngControl?e.ngControl.value:e._value)})},n.prototype._setSelectionByValue=function(e){var t=this;if(this.isMultiSelect&&e){if(!Array.isArray(e))throw Error("Value must be an array in multiselect mode.");this._selectionModel.clear(),e.forEach(function(e){return t._selectValue(e)}),this._sortValues()}else{this._selectionModel.clear();var n=this._selectValue(e);n&&this._keyManager.setActiveItem(n)}this._changeDetectorRef.markForCheck()},n.prototype._selectValue=function(e){var t=this,n=this.options.find(function(n){try{return null!=n.value&&t._compareWith(n.value,e)}catch(e){return a.isDevMode()&&console.warn(e),!1}});return n&&this._selectionModel.select(n),n},n.prototype._propagateChanges=function(e){var t=null;t=this.isMultiSelect?this.selected.map(function(e){return e.value}):this.selected?this.selected.value:e,this._value=t,this.valueChange.emit(t),this._onChange(t),this.selectionChange.emit(new O(this,t)),this._changeDetectorRef.markForCheck()},n.prototype._sortValues=function(){if(this.isMultiSelect){var e=this.options.toArray();this._selectionModel.sort(function(t,n){return e.indexOf(t)-e.indexOf(n)}),this.stateChanges.next()}},n.prototype._updatePositionOffset=function(){var e=0;if(null!==this.formFieldComponent){var t=this.formFieldComponent.elementRef.nativeElement.getBoundingClientRect(),n=this._elementRef.nativeElement.getBoundingClientRect(),o=this.overlayDir.overlayRef.overlayElement.querySelector(".nx-dropdown__panel-header"),i=o?parseInt(getComputedStyle(o).paddingTop,10):0;e=t.top-n.top-i}this._positions[0].offsetY=e},n.prototype.focus=function(){this._elementRef.nativeElement.focus()},n.prototype.openPanel=function(){!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._panelOpen=!0,this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())},n.prototype.closePanel=function(){var e=this;this._panelOpen&&(this._panelOpen=!1,this.isStable=!1,this._keyManager.withHorizontalOrientation("ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.openedChange.emit(!1),setTimeout(function(){return e.focus()}))},n.prototype._calculateScrollTop=function(){if(this.panelBody.nativeElement.scrollTop=0,!this.empty){var e=this._getItemOffset(this._keyManager.activeItem),t=this.panelBody.nativeElement.offsetHeight,n=this.panelBody.nativeElement.getBoundingClientRect().top+t/2;e>n&&(this.panelBody.nativeElement.scrollTop=e-n)}},n.prototype._scrollActiveOptionIntoView=function(){if(this.panelOpen&&this._keyManager.activeItem){var e=this._keyManager.activeItem.containerElement.nativeElement,t=this.panelBody.nativeElement,n=t.offsetTop,o=t.scrollTop,i=t.clientHeight,r=e.offsetTop-n,a=e.offsetTop-n+e.getBoundingClientRect().height;r<o?this.panelBody.nativeElement.scrollTop=r:a>o+i&&(this.panelBody.nativeElement.scrollTop=a-i)}},n.prototype._getItemOffset=function(e){var t=e.containerElement.nativeElement.getBoundingClientRect();return t.top+t.height/2},n.prototype.setDescribedByIds=function(e){this.ariaDescribedby=e.join(" ")},n.prototype.setAriaLabel=function(e){this._ariaLabel=e},n.prototype._getAriaLabel=function(){return this._ariaLabel||(this.formFieldComponent?this.formFieldComponent.label:null)},Object.defineProperty(n.prototype,"_isInOutlineField",{get:function(){return null!==this.formFieldComponent&&"outline"===this.formFieldComponent.appearance},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"empty",{get:function(){return!this._selectionModel||this._selectionModel.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasValue",{get:function(){return this._selectionModel.hasValue()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shouldLabelFloat",{get:function(){return this.focused||!this.empty},enumerable:!0,configurable:!0}),n.prototype.writeValue=function(e){this.options&&this._setSelectionByValue(e)},n.prototype.registerOnChange=function(e){this._onChange=e},n.prototype.registerOnTouched=function(e){this._onTouched=e},n.prototype.setDisabledState=function(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()},n.prototype._handleKeydown=function(e){this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e)},n.prototype._handleClosedKeydown=function(e){var t=e.keyCode,n=t===p.DOWN_ARROW||t===p.UP_ARROW||t===p.LEFT_ARROW||t===p.RIGHT_ARROW;t===p.ENTER||t===p.SPACE||(this.isMultiSelect||e.altKey)&&n?(e.preventDefault(),this.openPanel()):this.isMultiSelect||this.disabled||this._keyManager.onKeydown(e)},n.prototype._handleOpenKeydown=function(e){var t=this,n=e.keyCode;if([p.DOWN_ARROW,p.UP_ARROW,p.HOME,p.END,p.ENTER,p.LEFT_ARROW,p.RIGHT_ARROW,p.SHIFT,p.SPACE,p.TAB].indexOf(n)>=0||!this.showFilter){var o=n===p.DOWN_ARROW||n===p.UP_ARROW,i=this._keyManager,r=this.options.map(function(e){return e._hidden}).every(function(e){return Boolean(e)});if(n===p.HOME||n===p.END)e.preventDefault(),n===p.HOME?i.setFirstItemActive():i.setLastItemActive();else if(o&&e.altKey)e.preventDefault(),this.closePanel();else if(n===p.ENTER&&i.activeItem&&!r)e.preventDefault(),i.activeItem._selectViaInteraction();else if(n===p.ENTER&&r)e.preventDefault(),this.closePanel();else if(!this.showFilter&&n===p.SPACE&&i.activeItem)e.preventDefault(),i.activeItem._selectViaInteraction();else if(n===p.TAB)this.closePanel();else{var a=i.activeItemIndex;i.onKeydown(e),this._ngZone.onStable.asObservable().pipe(h.take(1),h.delay(251)).subscribe(function(){t.isStable=!0,t._changeDetectorRef.detectChanges()}),this.isMultiSelect&&o&&e.shiftKey&&i.activeItem&&i.activeItemIndex!==a&&i.activeItem._selectViaInteraction()}}},n.prototype.formatValue=function(e){return this.valueFormatter(e)},n.prototype._onFilter=function(e){e.preventDefault(),this.currentFilter=e.target.value,this.filterChanges.next(e.target.value),this.options.map(function(e){return e._hidden}).every(function(e){return Boolean(e)})?this._keyManager.setActiveItem(null):this._keyManager.setFirstItemActive()},Object.defineProperty(n.prototype,"triggerValue",{get:function(){return this.empty?"":this.isMultiSelect?this._selectionModel.selected.map(function(e){return e.viewValue}).join(", "):this._selectionModel.selected[0].viewValue},enumerable:!0,configurable:!0}),n.prototype._highlightCorrectOption=function(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))},n.prototype._onAttached=function(){var e=this;this.overlayDir.positionChange.pipe(h.take(1)).subscribe(function(){var t=e.overlayDir.overlayRef,n=t.getConfig().positionStrategy;e._updatePositionOffset(),n.withPositions(e._positions.slice()),t.updatePosition(),e._keyManager.activeItem&&e._calculateScrollTop(),e._changeDetectorRef.markForCheck(),e.openedChange.emit(!0),e.showFilter&&!e._value?e.filterInput.nativeElement.focus():e.panelBody.nativeElement.focus()})},n.prototype._onFocus=function(){this.disabled||(this._focused=!0,this.stateChanges.next())},n.prototype._onBlur=function(){this._focused=!1,this.filterInput&&this.showFilter&&this._clearFilter(),this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())},Object.defineProperty(n.prototype,"isFilterEmpty",{get:function(){return 0===this.currentFilter.length},enumerable:!0,configurable:!0}),n.prototype._clearFilter=function(){this.filterInput.nativeElement.value="",this.currentFilter="",this.filterChanges.next("")},n.prototype._getAriaActiveDescendant=function(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null},n.decorators=[{type:a.Component,args:[{selector:"nx-dropdown",template:'\n\x3c!-- input and stuff--\x3e\n<div cdkOverlayOrigin\n    #origin="cdkOverlayOrigin"\n    class="nx-dropdown__container"\n    #trigger>\n  <div class="nx-dropdown__rendered">\n    <ng-container *ngTemplateOutlet="closedDropdownLabel"></ng-container>\n  </div>\n  <div class="nx-dropdown__icon">\n    <nx-icon class="nx-dropdown__chevron" name="chevron-down"></nx-icon>\n  </div>\n</div>\n\n<ng-template #defaultClosedDropdownLabel>\n  <span *ngIf="triggerValue">{{ triggerValue }}</span>\n</ng-template>\n\n\x3c!-- overlay --\x3e\n<ng-template\n  cdkConnectedOverlay\n  cdkConnectedOverlayHasBackdrop\n  cdkConnectedOverlayBackdropClass="cdk-overlay-transparent-backdrop"\n  [cdkConnectedOverlayOrigin]="origin"\n  [cdkConnectedOverlayOpen]="panelOpen"\n  [cdkConnectedOverlayPositions]="_positions"\n  [cdkConnectedOverlayMinWidth]="_triggerRect?.width"\n  [cdkConnectedOverlayFlexibleDimensions]="true"\n  [cdkConnectedOverlayViewportMargin]="_overlayViewportMargin"\n  [cdkConnectedOverlayPush]="true"\n  (backdropClick)="closePanel()"\n  (attach)="_onAttached()"\n  (detach)="closePanel()">\n\n  <div class="nx-dropdown__panel"\n      [class.has-filter]="showFilter"\n      [class.nx-dropdown__panel--in-outline-field]="_isInOutlineField"\n      (keydown)="_handleKeydown($event)"\n      #panel>\n    <div class="nx-dropdown__panel-header" *ngIf="label">\n      {{ label }}\n    </div>\n    <div class="nx-dropdown__filter" *ngIf="showFilter">\n      <input class="nx-dropdown__filter-input"\n             [class.is-filled]="!isFilterEmpty"\n             #filterInput\n             type="text"\n             (input)="_onFilter($event)"\n             [placeholder]="filterPlaceholder"\n      >\n      <span class="nx-dropdown__filter-icon" *ngIf="!isFilterEmpty" (click)="_clearFilter()">\n        <nx-icon name="close"></nx-icon>\n      </span>\n    </div>\n\n    <div class="nx-dropdown__panel-body"\n         tabindex="-1"\n         role="listbox"\n         #panelBody\n         [class.is-stable]="isStable"\n         [attr.aria-activedescendant]="_getAriaActiveDescendant()"\n         [attr.aria-multiselectable]="isMultiSelect"\n    >\n        <ng-content></ng-content>\n      </div>\n  </div>\n</ng-template>\n',changeDetection:a.ChangeDetectionStrategy.OnPush,providers:[{provide:y,useExisting:n},{provide:t.NxFormfieldControl,useExisting:n}],host:{role:"button","[class.nx-dropdown]":"true","[class.is-filled]":"hasValue","[class.has-focus]":"focused","[class.nx-dropdown--negative]":"_negative","[class.nx-dropdown--disabled]":"disabled","[attr.aria-describedby]":"ariaDescribedby || null","[attr.aria-required]":"required","[attr.aria-label]":"_getAriaLabel()","aria-haspopup":"listbox","[attr.aria-expanded]":"panelOpen","[attr.disabled]":"disabled || null","[attr.tabindex]":"tabIndex","(keydown)":"_handleKeydown($event)","(focus)":"_onFocus()","(blur)":"_onBlur()","(click)":"openPanel()"},styles:[":host{display:block;width:100%}:host:focus{outline:0}:host(.nx-dropdown--negative):focus{font-weight:600}:host(.nx-dropdown--negative){color:#fff}.nx-dropdown__container{display:flex;justify-content:flex-end;align-items:center;height:100%;cursor:pointer}:host(.nx-dropdown--disabled) .nx-dropdown__container{cursor:not-allowed}.nx-dropdown__rendered{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.nx-dropdown__panel{box-shadow:0 2px 4px rgba(65,65,65,.5);border-radius:4px;min-width:100%}.nx-dropdown__panel ::ng-deep .nx-checkbox__label{font-size:20px;font-size:var(--dropdown-item-font-size,20px);line-height:28px;line-height:var(--dropdown-item-line-height,28px);font-weight:400;font-weight:var(--dropdown-item-font-weight,400);letter-spacing:.2px;letter-spacing:var(--dropdown-item-letter-spacing,.2px);display:flex;align-items:center}.nx-dropdown__panel:focus{outline:0}.nx-dropdown__panel--in-outline-field .nx-dropdown__panel-header{font-size:16px;font-size:var(--formfield-outline-label-font-size,16px);line-height:24px;line-height:var(--formfield-outline-label-line-height,24px);font-weight:600;font-weight:var(--formfield-outline-label-font-weight,600);letter-spacing:0;letter-spacing:var(--formfield-outline-label-letter-spacing,0)}.nx-dropdown__panel--in-outline-field .nx-dropdown__panel-body{max-height:calc(5 * (24px + 16px) + 16px);max-height:calc(5 * (var(--dropdown-item-outline-line-height,24px) + 16px) + 16px)}.nx-dropdown__panel--in-outline-field ::ng-deep .nx-dropdown-results__group-label{font-size:16px;font-size:var(--formfield-outline-label-font-size,16px);line-height:24px;line-height:var(--formfield-outline-label-line-height,24px);font-weight:var(--formfield-outline-label-font-weight,600);letter-spacing:0;letter-spacing:var(--formfield-outline-label-letter-spacing,0);font-style:normal;font-weight:700}.nx-dropdown__panel--in-outline-field ::ng-deep nx-dropdown-item .nx-dropdown-results__option,.nx-dropdown__panel--in-outline-field ::ng-deep nx-dropdown-item .nx-dropdown-results__option-label{font-size:16px;font-size:var(--dropdown-item-outline-font-size,16px);line-height:24px;line-height:var(--dropdown-item-outline-line-height,24px);font-weight:400;font-weight:var(--dropdown-item-outline-font-weight,400);letter-spacing:0;letter-spacing:var(--dropdown-item-outline-letter-spacing,0)}.nx-dropdown__panel--in-outline-field ::ng-deep nx-dropdown-item .nx-dropdown-results__option-checkicon{height:24px;height:var(--dropdown-item-outline-line-height,24px)}.nx-dropdown__panel--in-outline-field ::ng-deep .nx-dropdown__filter-input{font-size:16px;font-size:var(--formfield-outline-control-font-size,16px);line-height:24px;line-height:var(--formfield-outline-control-line-height,24px);font-weight:400;font-weight:var(--formfield-outline-control-font-weight,400);letter-spacing:0;letter-spacing:var(--formfield-outline-control-letter-spacing,0)}.nx-dropdown__panel--in-outline-field ::ng-deep .nx-dropdown__filter-input:empty{font-weight:300}.nx-dropdown__icon{font-size:24px;font-size:var(--dropdown-chevron-size,24px);line-height:0}.nx-dropdown__chevron{vertical-align:middle}.nx-dropdown__panel-header{font-size:12px;font-size:var(--formfield-label-font-size,12px);line-height:16px;line-height:var(--formfield-label-line-height,16px);font-weight:600;font-weight:var(--formfield-label-font-weight,600);letter-spacing:.5px;letter-spacing:var(--formfield-label-letter-spacing,.5px);color:#414141;color:var(--dropdown-panel-header-text-color,#414141);background-color:#ececec;background-color:var(--dropdown-panel-header-background-color,#ececec);padding:8px 32px;border-top-left-radius:4px;border-top-right-radius:4px;z-index:1}.nx-dropdown__panel-body{background-color:#fff;background-color:var(--dropdown-panel-background-color,#fff);max-height:calc(5 * (28px + 16px) + 16px);max-height:calc(5 * (var(--dropdown-item-line-height,28px) + 16px) + 16px);overflow-y:auto;outline:0}.nx-dropdown__filter{position:relative;padding:16px 32px 12px;background-color:#fff;background-color:var(--dropdown-panel-background-color,#fff)}.nx-dropdown__filter-input{font-size:20px;font-size:var(--formfield-control-font-size,20px);line-height:28px;line-height:var(--formfield-control-line-height,28px);font-weight:var(--formfield-control-font-weight,600);letter-spacing:.2px;letter-spacing:var(--formfield-control-letter-spacing,.2px);border:0;border-bottom:1px solid #767676;border-bottom:1px var(--dropdown-filter-input-border-color,#767676) solid;color:#414141;color:var(--dropdown-filter-input-text-color,#414141);width:100%;outline:0;background-color:transparent;padding:0 24px 3px 0;font-weight:300}.nx-dropdown__filter-input::-ms-clear{display:none}.nx-dropdown__panel.has-filter ::ng-deep nx-dropdown-item:first-of-type .nx-dropdown-results__option{padding-top:12px}.nx-dropdown__filter-icon{position:absolute;height:24px;right:32px;top:calc(16px + 1px);cursor:pointer}.nx-dropdown__filter-icon nx-icon{font-size:24px}.nx-dropdown__filter-input:focus{border-color:#007ab3;border-color:var(--dropdown-filter-input-active-border-color,#007ab3)}.nx-dropdown__filter-input.is-filled:focus{font-weight:600;color:#007ab3;color:var(--dropdown-filter-input-active-text-color,#007ab3);border-color:#007ab3;border-color:var(--dropdown-filter-input-active-border-color,#007ab3)}.nx-dropdown__filter-input.is-filled:focus+.nx-dropdown__filter-icon{color:#007ab3;color:var(--dropdown-filter-input-active-text-color,#007ab3)}@media screen and (-ms-high-contrast:active){.nx-dropdown__panel{box-shadow:0 0 0 1px windowText}.nx-dropdown__panel-header{border-bottom:1px solid windowText}.nx-dropdown__filter-input{border-bottom-color:buttonText}}"]}]}],n.ctorParameters=function(){return[{type:a.ChangeDetectorRef},{type:a.ElementRef},{type:a.NgZone},{type:String,decorators:[{type:a.Attribute,args:["tabindex"]}]},{type:t.NxFormfieldComponent,decorators:[{type:a.Optional}]},{type:c.NgControl,decorators:[{type:a.Self},{type:a.Optional}]},{type:c.NgForm,decorators:[{type:a.Optional}]},{type:c.FormGroupDirective,decorators:[{type:a.Optional}]}]},n.propDecorators={tabIndex:[{type:a.Input}],_ariaLabel:[{type:a.Input,args:["nxAriaLabel"]}],value:[{type:a.Input,args:["nxValue"]}],disabled:[{type:a.Input,args:["nxDisabled"]}],required:[{type:a.Input,args:["nxRequired"]}],styles:[{type:a.Input,args:["nxStyle"]}],showFilter:[{type:a.Input,args:["nxShowFilter"]}],filterPlaceholder:[{type:a.Input,args:["nxFilterPlaceholder"]}],openedChange:[{type:a.Output}],_openedStream:[{type:a.Output,args:["opened"]}],_closedStream:[{type:a.Output,args:["closed"]}],filterChanges:[{type:a.Output,args:["filterInput"]}],valueChange:[{type:a.Output,args:["nxValueChange"]}],selectionChange:[{type:a.Output}],panel:[{type:a.ViewChild,args:["panel",{static:!1}]}],panelBody:[{type:a.ViewChild,args:["panelBody",{static:!1}]}],trigger:[{type:a.ViewChild,args:["trigger",{static:!0}]}],filterInput:[{type:a.ViewChild,args:["filterInput",{static:!1}]}],overlayDir:[{type:a.ViewChild,args:[i.CdkConnectedOverlay,{static:!0}]}],options:[{type:a.ContentChildren,args:[C,{descendants:!0}]}],groups:[{type:a.ContentChildren,args:[b]}],_customClosedDropdownLabel:[{type:a.ContentChild,args:[k,{static:!1}]}],_defaultClosedDropdownLabel:[{type:a.ViewChild,args:["defaultClosedDropdownLabel",{static:!0}]}],valueFormatter:[{type:a.Input,args:["nxValueFormatter"]}],compareWith:[{type:a.Input}],filterFn:[{type:a.Input}]},n}(y);var S=function(){function e(){}return e.decorators=[{type:a.NgModule,args:[{imports:[r.CommonModule,t.NxFormfieldModule,l.NxCheckboxModule,i.OverlayModule,o.A11yModule,n.NxIconModule,u.ObserversModule],declarations:[I,C,b,k],exports:[I,C,b,k]}]}],e}();e.NxDropdownComponent=I,e.NxDropdownGroupComponent=b,e.NxDropdownItemChange=v,e.NxDropdownItemComponent=C,e.NxDropdownModule=S,e.NxDropdownSelectChange=O,e.ɵa=y,e.ɵb=k,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=allianz-ngx-ndbx-dropdown.umd.min.js.map